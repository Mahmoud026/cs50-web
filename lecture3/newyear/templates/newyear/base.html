{# Load required Django template tags #}
{% load static %}  {# For serving static files #}
{% load i18n %}   {# For internationalization support #}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Holiday Checker - Track New Year, Eid, and Ramadan">
    {# Dynamic title block that can be overridden by child templates #}
    <title>{% block title %}{% trans 'Holiday Checker' %}{% endblock %}</title>
    {# Main stylesheet for consistent styling across all pages #}
    <link rel="stylesheet" href="{% static 'newyear/styles.css' %}">
    {% block extra_head %}{% endblock %}
</head>

{# Body class is customizable per template for different background styles #}
<body class="{% block body_class %}newyear-bg{% endblock %}">
    <main>
        <div class="landing-container">
                        {# User Controls Section #}
            <div class="user-controls">
                {# Language Selector #}
                <form action="" method="get" id="lang-form" class="control-form">
                    <select name="lang" id="lang-select" aria-label="{% trans 'Select language' %}" class="select-control">
                        <option value="en" {% if LANGUAGE_CODE == 'en' %}selected{% endif %}>{% trans 'English' %}</option>
                        <option value="ar" {% if LANGUAGE_CODE == 'ar' %}selected{% endif %}>{% trans 'Arabic' %}</option>
                    </select>
                </form>

                {# Timezone Selector #}
                <form action="" method="get" id="tz-form" class="control-form">
                    <label for="tz-select" class="sr-only">{% trans 'Select time zone' %}</label>
                    <select name="tz" id="tz-select" aria-label="{% trans 'Select time zone' %}" class="select-control">
                        <option value="UTC" {% if tz == 'UTC' or not tz %}selected{% endif %}>UTC</option>
                        <option value="Asia/Riyadh" {% if tz == 'Asia/Riyadh' %}selected{% endif %}>Asia/Riyadh</option>
                        <option value="Europe/London" {% if tz == 'Europe/London' %}selected{% endif %}>Europe/London</option>
                        <option value="America/New_York" {% if tz == 'America/New_York' %}selected{% endif %}>America/New_York</option>
                        <option value="Asia/Kolkata" {% if tz == 'Asia/Kolkata' %}selected{% endif %}>Asia/Kolkata</option>
                        <option value="Asia/Tokyo" {% if tz == 'Asia/Tokyo' %}selected{% endif %}>Asia/Tokyo</option>
                    </select>
                </form>

                {# Theme Toggle #}
                <button id="theme-toggle" aria-label="{% trans 'Toggle dark/light mode' %}" class="theme-toggle">
                    <span id="theme-icon">üåô</span>
                </button>
            </div>

            {# Timezone Display #}
            {% if tz %}
                <div class="timezone-display">{% trans 'Current time zone:' %} <strong>{{ tz }}</strong></div>
            {% endif %}

            {# Main Navigation
               Contains links to all holiday checkers with bilingual support #}
            <nav aria-label="Main event navigation" role="navigation">
                <div class="event-links">
                    {# New Year Link #}
                    <a class="event-link" href="/newyear/check/" aria-label="Check if today is New Year" role="button">
                        <span style="font-size:1.5em;vertical-align:middle;">üéâ</span> {% trans 'New Year' %} / <span dir="rtl" lang="ar">{% language 'ar' %}{% trans 'New Year' %}{% endlanguage %}</span>
                    </a>
                    {# Eid al-Fitr Link #}
                    <a class="event-link" href="/newyear/eid-fitr/" aria-label="Check if today is Eid al-Fitr" role="button">
                        <span style="font-size:1.5em;vertical-align:middle;">üåô</span> {% trans 'Eid al-Fitr' %} / <span dir="rtl" lang="ar">{% language 'ar' %}{% trans 'Eid al-Fitr' %}{% endlanguage %}</span>
                    </a>
                    {# Eid al-Adha Link #}
                    <a class="event-link" href="/newyear/eid-adha/" aria-label="Check if today is Eid al-Adha" role="button">
                        <span style="font-size:1.5em;vertical-align:middle;">üïã</span> {% trans 'Eid al-Adha' %} / <span dir="rtl" lang="ar">{% language 'ar' %}{% trans 'Eid al-Adha' %}{% endlanguage %}</span>
                    </a>
                    {# Ramadan Link #}
                    <a class="event-link" href="/newyear/ramadan/" aria-label="Check if today is Ramadan" role="button">
                        <span style="font-size:1.5em;vertical-align:middle;">üïå</span> {% trans 'Ramadan' %} / <span dir="rtl" lang="ar">{% language 'ar' %}{% trans 'Ramadan' %}{% endlanguage %}</span>
                    </a>
                </div>
            </nav>

            {# Content Blocks
               These blocks will be filled by child templates #}
            {% block pre_content %}{% endblock %}
            {% block content %}{% endblock %}
        </div>
    </main>

    {# Interactive Features JavaScript
       Handles language switching, timezone selection, and theme toggling #}
    <script>
        /**
         * Language Switcher
         * Updates the URL with the selected language and reloads the page
         */
        document.getElementById('lang-select').addEventListener('change', function() {
            const lang = this.value;
            const url = new URL(window.location.href);
            url.searchParams.set('lang', lang);
            window.location.href = url.toString();
        });

        /**
         * Timezone Switcher
         * Updates the URL with the selected timezone and reloads the page
         */
        document.getElementById('tz-select').addEventListener('change', function() {
            const tz = this.value;
            const url = new URL(window.location.href);
            url.searchParams.set('tz', tz);
            window.location.href = url.toString();
        });

        /**
         * Theme System
         * Manages dark/light mode preferences and persistence
         */
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');

        // Theme setting function
        function setTheme(mode) {
            if (mode === 'light') {
                document.body.classList.add('light-mode');
                themeIcon.textContent = '‚òÄÔ∏è';
            } else {
                document.body.classList.remove('light-mode');
                themeIcon.textContent = 'üåô';
            }
            // Save theme preference to localStorage
            localStorage.setItem('theme', mode);
        }

        // Load saved theme preference on page load
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) setTheme(savedTheme);

        // Theme toggle click handler
        themeToggle.addEventListener('click', function() {
            const isLight = document.body.classList.contains('light-mode');
            setTheme(isLight ? 'dark' : 'light');
        });
    </script>
</body>
</html> 